
import pyzipper
import os

zip_password = b'infected'
malware_path = '../../DataSet/malware/'
malwares = os.listdir(malware_path)

def unzip_file(file):
    with pyzipper.AESZipFile(file) as zf:
        zf.pwd = zip_password
        my_secrets = zf.extractall(malware_path)
        print("Sample \""+file+"\" unpacked.")

# loop through all files in the malware directory unpack them and delete the .zip file
for counter, file_name in enumerate(malwares):
    unzip_file(malware_path + file_name)
    os.remove(malware_path + file_name)

print('done')
